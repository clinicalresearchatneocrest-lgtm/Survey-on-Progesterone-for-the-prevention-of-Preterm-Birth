<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>SurveyJS – Diagnostic</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- SurveyJS (vanilla) -->
  <link href="https://unpkg.com/survey-core/survey-core.min.css" rel="stylesheet" />
  <script src="https://unpkg.com/survey-core/survey.core.min.js"></script>
  <script src="https://unpkg.com/survey-js-ui/survey-js-ui.min.js"></script>

  <style>
    body { margin: 24px; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; }
    #wrap { max-width: 960px; margin: 0 auto; }
    #banner { padding: 10px 12px; border: 1px solid #ddd; border-radius: 10px; background: #f7f7f7; margin-bottom: 12px; }
    #status { font-size: 13px; margin-top: 8px; }
    #errbox {
      background:#fff3cd; color:#664d03; border:1px solid #ffecb5;
      padding:12px; border-radius:8px; margin:12px 0; display:none;
      white-space:pre-wrap; font-family:ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
    }
    #surveyContainer { margin-top: 12px; }
  </style>
</head>

<body>
<div id="wrap">
  <div id="banner">
    ✅ <b>PAGE LOADED</b> — if you can see this, GitHub Pages is serving your HTML correctly.
    <div id="status">Checking SurveyJS…</div>
  </div>

  <div id="errbox"></div>
  <div id="surveyContainer"></div>
</div>

<script>
  // --- error box ---
  const errbox = document.getElementById("errbox");
  function showErr(msg) {
    errbox.style.display = "block";
    errbox.textContent = String(msg);
    console.error(msg);
  }
  window.addEventListener("error", (e) => {
    showErr("JS Error: " + e.message + "\n" + (e.error && e.error.stack ? e.error.stack : ""));
  });
  window.addEventListener("unhandledrejection", (e) => {
    showErr("Promise Error: " + (e.reason && (e.reason.stack || e.reason.message) || e.reason));
  });

  // --- status ---
  const statusEl = document.getElementById("status");
  function setStatus(t) { statusEl.textContent = t; }

  // --- test SurveyJS ---
  (function init() {
    if (!window.Survey || !Survey.Model) {
      setStatus("❌ SurveyJS NOT loaded. unpkg blocked or scripts not loading.");
      showErr(
        "SurveyJS library did not load.\n" +
        "Open DevTools → Console + Network and check these are 200:\n" +
        "https://unpkg.com/survey-core/survey.core.min.js\n" +
        "https://unpkg.com/survey-js-ui/survey-js-ui.min.js"
      );
      return;
    }

    setStatus("✅ SurveyJS loaded. Rendering test survey…");

    const surveyJson = {
      title: "Test Survey (If you see this, SurveyJS rendering works)",
      pages: [
        {
          name: "p1",
          elements: [
            { type: "text", name: "name", title: "Your name", isRequired: true },
            { type: "radiogroup", name: "q1", title: "Pick one", choices: ["A","B","C"], isRequired: true }
          ]
        }
      ]
    };

    const survey = new Survey.Model(surveyJson);
    survey.onComplete.add((s) => {
      alert("Test survey completed. Data: " + JSON.stringify(s.data));
    });

    survey.render(document.getElementById("surveyContainer"));
  })();
</script>
</body>
</html>
